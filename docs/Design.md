# Second Brain Web应用项目设计文档

## 项目概述

### 项目背景

Second Brain Web应用是一个集成AI对话、智能研究助手和个人知识管理的在线平台。

### 项目愿景

构建一个由AI驱动的个人知识管理系统，帮助用户高效地收集、组织、理解和应用知识，成为用户的"第二大脑"。通过AI技术的深度应用，让每个人都能够更高效地获取和整理知识、更深入地理解和关联信息、更智能地应用和创造价值。

### 核心价值

- 智能化知识管理：通过AI技术自动整理、关联和提取知识，不仅存储数据，更鼓励内容的标注、归纳、总结和扩展
- 深度研究辅助：自动化信息收集和分析，提升研究效率，一键启动全流程研究
- 交互式学习体验：结合文档管理和AI对话，实现边学边问，精确到页码和段落的智能问答
- 知识自动关联：AI自动发现和构建知识联系，形成完整的认知网络

### 目标用户

- 学生群体：管理学习资料、提高学习效率、准备考试、学术研究、团队项目协作
- 科研人员：文献管理、研究分析、论文写作、学术交流
- 知识工作者：信息整理、知识积累、工作效率提升、持续学习

## 功能架构

### 三大核心模块

#### AI对话（Chat）

双模式支持：

- Chat模式：与AI大模型直接对话
  - 支持的模型：OpenAI (GPT-4.1、o4-mini等)、Google (Gemini 2.5 Pro/Flash等)、Anthropic (Claude 4/3.7 Sonnet等)、国产模型 (DeepSeek R1/V3)
  - 本地模型支持：通过Ollama/LM Studio接入
  - 特色功能：流式输出、上下文记忆、对话分支管理、一键重新生成、导出功能
- Search模式：通过Perplexity API进行联网搜索
  - 可选模型：Sonar（快速便宜）、Sonar Pro（高级查询）
  - 特色功能：实时网络检索、来源链接展示、信息可信度标注、关键信息高亮

界面设计：

- 顶部工具栏：新建对话、对话历史、更多选项
- 对话区域：消息气泡、Markdown渲染、代码高亮、数学公式、图片预览
- 输入控制：模式切换、模型选择、多行输入、快捷键支持

#### 智能代理（Agents）

Deep Research代理（初期重点）：

- 基于Perplexity Deep Research API
- 自动创建主题Space并保存相关文献
- 支持通用模式和学术模式
- 初期将使用Perplexity提供的Deep Research API，第二个版本计划基于Google的开源项目，参考Google Gemini Fullstack LangGraph Quickstart，改造出支持多个API的Deep Research Agent。

扩展计划：后续可添加AI PPT生成、代码助手、写作助手等

#### 知识库（Space）

- 多Space管理：用户可创建多个独立的知识空间，支持分类管理
- 文件支持：
  - 文档：PDF、Word、PPT、Excel
  - 文本：Markdown、TXT、代码文件
  - 图片：JPG、PNG、GIF
  - 网页：URL链接、网页快照
  - 学术：BibTeX引用文件
- 智能对话：在Space内与AI对话，引用多个文件提高准确性
- 笔记功能：Markdown格式笔记，支持实时编辑、版本历史、导出分享

### 界面布局设计

#### 主界面

```
┌─────────────┬────────────────────────────────┐
│   侧边栏     │          主内容区               │
├─────────────┤                                │
│ 💬 聊天     ｜                                │
│ 🤖 Agents   │      根据选择展示不同内容         │
│   └ Deep    │                                │
│     Research│                                │
│ 📁 Space    │                                │
│   └ 暂存箱   │                                │
│   └ 项目1    │                                │
│   └ 项目2    │                                │
└─────────────┴────────────────────────────────┘
```

#### Deep Research 入口界面

```
┌────────────────────────────────────────────────┐
│              Deep Research (Beta)              │
│                                                │
│             [通用]     [学术]                   │
│                                                │
│        ┌──────────────────────────┐            │
│        │                          │            │
│        │   您今天想研究什么？        │            │
│        │                          │            │
│        └──────────────────────────┘            │
│                                                │
│                                                │
│                                                │
└────────────────────────────────────────────────┘
```

#### 聊天界面

```
┌────────────────────────────────────────────────┐
│  你好，                                         │
│  我今天能帮你什么？                               │
│                                                │  
│                                                │
│ ┌────────────────────────────────────────┐     │
│ │  询问AI任何问题...                       │     │
│ │                                        │     │
│ └────────────────────────────────────────┘     │
│  [○ Chat] [○ Search]  [DeepSeek ▼]  [发送]      │
│                                                │
│                                                │  
│                                                │
│                                                │
└────────────────────────────────────────────────┘
```

#### Space列表界面

```
┌────────────────────────────────────────────────┐
│        欢迎来到Second Brain Space               │
│                                                │
│  Space是一个由AI驱动的知识库，简化了您从...         │
│                                                │
│  [+ 创建Space]                                  │
│                                                │
│  ┌─────────────┐  ┌─────────────┐              │
│  │     📁      │  │     📁      │              │
│  │             │  │             │              │
│  │ 研究项目1    │  │ 研究项目2   │                │
│  │             │  │             │              │
│  │ 2025年5月23日│  │ 2025年5月20日│              │
│  └─────────────┘  └─────────────┘              │
│                                                │
└────────────────────────────────────────────────┘
```

#### Space详情页（AI对话增强模式）

```
┌─────────┬─────────────────┬──────────────┐
│  文件    │    AI对话区      │    笔记区    │
│  列表    │                 │             │
│         │  今天我能为你     │  笔记(22)    │
│ ☑文件1   │  提供什么帮助？   │              │
│ ☑文件2   │                 │             │
│ ☐文件3   │                 │             │
│         │                 │  +添加笔记    │
│ 选择来源 │  [DeepSeek ▼]    │             │
│ (全部)   │                 │  ·笔记1      │
│         │  [询问AI...]     │  ·笔记2      │
│ +添加文件│                  │  ·笔记3      │
└─────────┴─────────────────┴──────────────┘
```

#### 文档预览界面

```
┌─────────┬─────────────────┬──────────────┐
│ 文件列表 │   PDF文档预览    │  AI聊天/笔记   │
│         │                 │              │
│ ☉文件1  │ ┌─────────────┐ │              │
│ ○文件2   │ │             │ │              │
│ ○文件3   │ │  论文内容    │ │              │
│         │ │             │ │              │
│ 选择来源 │ │  [AI助手]    │ │              │
│ (1)     │ │             │ │              │
│         │ └─────────────┘ │              │
│ +添加    │                 │              │
│         │ [全文翻译][下载]  │              │
└─────────┴─────────────────┴──────────────┘
```

## 详细功能说明

### 聊天功能

- 界面元素：
  - 模型选择器（下拉菜单）- 显示所有可用模型
  - 模式切换按钮（Chat/Search）- 明显的切换标识
  - 消息输入框 - 支持多行输入、粘贴图片
  - 对话历史显示区 - 时间戳、模型标识
- 功能特性：
  - 实时流式响应 - 逐字显示，提升体验
  - 代码高亮显示 - 支持多种编程语言
  - 引用来源标注（Search模式）- 可点击跳转
  - 数学公式渲染 - LaTeX支持
  - 图片内容理解 - 支持图片上传分析

### Deep Research功能

#### 入口界面设计

页面布局：

- 中心大标题："Deep Research (Beta)"
- 副标题说明："您今天想研究什么？"
- 模式选择标签：通用 | 学术
- 中央输入框：支持中英文，回车触发
- 底部说明文字

#### 工作流程

1. 用户选择研究模式（通用/学术）
2. 输入研究主题并回车
3. 显示研究进度界面
4. 系统调用Deep Research API
5. 自动创建主题Space
6. 收集相关文献和资料
7. 整理并保存至Space
8. 研究完成后自动跳转

#### 研究模式对比

- 通用模式：
  - 信息源：网络搜索、新闻、博客、社交媒体
  - 适用场景：市场调研、技术趋势、热点分析
  - 结果特点：时效性强、覆盖面广、易于理解
- 学术模式：
  - 信息源：学术数据库、期刊论文、会议文献、预印本
  - 适用场景：文献综述、理论研究、学术写作
  - 结果特点：权威性高、引用完整、理论深度

### Space管理

#### Space列表页

界面设计：

- 顶部欢迎语："欢迎来到Second Brain"
- "+"创建新Space按钮
- Space卡片网格布局
- 每个卡片显示：图标、名称、更新时间、文件数

交互功能：

- 点击进入Space
- 右键菜单：重命名、删除、复制
- 拖拽排序
- 搜索过滤

#### Space详情页 - AI对话增强模式

三栏布局：

- 左栏 - 文件管理：
  - 文件列表展示
  - 复选框多选
  - 添加文件按钮
  - 文件搜索
  - 已选计数器
- 中栏 - AI对话：
  - 模型选择器
  - 对话消息流
  - 文件引用标注
  - 快捷操作按钮
  - 输入区域
- 右栏 - 笔记管理：
  - Chat | Notes标签切换
  - 笔记列表
  - 添加笔记按钮
  - 笔记预览
  - 快速编辑

#### 文档预览模式

- 界面布局：
  - 左栏保持文件列表
  - 中间为文档查看器（PDF渲染、缩放控制、页面导航）
  - 右栏切换为标注和笔记功能
- PDF专属功能：
  - 高亮标注（5种颜色）
  - 下划线和批注
  - 区域框选
  - AI辅助（选中翻译、术语解释、段落总结）

### 3.4 笔记系统

#### 3.4.1 笔记类型

- **手动笔记**：用户创建和编辑
- **AI笔记**：自动生成的总结、要点、问答记录
- **关联笔记**：与特定文件或段落关联

#### 3.4.2 Markdown编辑器功能

- 实时预览
- 快捷工具栏
- LaTeX公式支持
- Mermaid图表
- 表格编辑器
- 代码高亮
- 图片上传

#### 3.4.3 笔记管理

- 标签分类系统
- 全文搜索
- 版本历史记录
- 多格式导出（MD/PDF/HTML）
- 分享链接生成

### 3.5 文件管理功能

#### 3.5.1 上传方式

- 拖拽上传（支持批量）
- 点击选择上传
- 剪贴板粘贴
- URL导入
- 文件夹上传

#### 3.5.2 文件操作

- 重命名、移动、复制
- 批量操作
- 标签管理
- 跨Space转移
- 文件夹组织

#### 3.5.3 智能功能

- 全文搜索（OCR支持）
- 相似文件检测
- 智能分类建议
- 自动元数据提取

## 4. 技术架构

### 4.1 前端技术栈

- **框架**：React
- **状态管理**：Zustand 
- Markdown编辑器
- **文件预览**：PDF.js、react-file-viewer
- **代码编辑**：Monaco Editor

### 4.2 后端技术栈

- **Web框架**：FastAPI
- **数据库**：PostgreSQL
- **缓存**：Redis
- **文件存储**：MinIO / 本地存储
- **容器化**：Docker Compose
- **包管理**：uv

### 4.3 API集成

- AI模型API：
  - OpenAI API
  - Google Gemini API
  - Anthropic Claude API
  - Deepseek API
  - 本地模型（Ollama）
- 搜索API：
  - Perplexity API (Search & Deep Research)

## 5. 数据模型设计

### 5.1 核心实体

```python
# 用户
User {
  id: UUID
  email: string
  username: string
  created_at: datetime
  preferences: JSON  # 用户偏好设置
}

# Space
Space {
  id: UUID
  user_id: UUID
  title: string
  description: string
  type: string  # normal/research
  created_at: datetime
  updated_at: datetime
  metadata: JSON  # 额外信息
}

# 文件
File {
  id: UUID
  space_id: UUID
  filename: string
  file_type: string
  file_path: string
  file_size: integer
  uploaded_at: datetime
  metadata: JSON  # OCR文本、标签等
}

# 对话记录
Conversation {
  id: UUID
  space_id: UUID
  user_id: UUID
  model: string
  mode: string  # chat/search
  messages: JSON
  created_at: datetime
  title: string  # 对话标题
}

# 笔记
Note {
  id: UUID
  space_id: UUID
  title: string
  content: text (Markdown)
  type: string  # manual/ai/linked
  file_refs: JSON  # 关联文件
  created_at: datetime
  updated_at: datetime
  tags: JSON
}

# 标注
Annotation {
  id: UUID
  file_id: UUID
  user_id: UUID
  type: string  # highlight/underline/note
  color: string
  content: text
  position: JSON  # 页码、坐标等
  created_at: datetime
}
```

## 6. 使用场景与工作流

### 6.1 学术研究场景

**场景描述**：研究生进行文献综述

1. 使用Deep Research学术模式搜索研究主题
2. 系统自动创建Space并收集相关论文
3. 上传导师推荐的补充文献
4. 勾选核心论文进行对比分析
5. AI精确定位并分析各论文方法论
6. 添加标注和个人见解
7. 生成文献综述大纲
8. 导出整理后的研究报告

### 6.2 课程学习场景

**场景描述**：大学生期末复习

1. 创建课程专属Space
2. 上传所有课件、教材、作业
3. 定期添加课堂笔记
4. 考前勾选所有资料让AI生成复习大纲
5. 针对薄弱知识点深入提问
6. 生成练习题自测
7. 制作知识卡片强化记忆

### 6.3 工作研究场景

**场景描述**：产品经理市场调研

1. 使用Deep Research通用模式研究市场趋势
2. 收集竞品信息和行业报告
3. 上传内部数据和用户反馈
4. 与AI对话分析竞争优势
5. 生成SWOT分析
6. 制作市场分析报告
7. 导出PPT素材分享团队

## 7. 简化实现策略

### 7.1 技术简化

- 使用成熟的UI组件库，避免自定义复杂组件
- 优先使用第三方服务（如文件预览），减少自研
- 采用简单的文件存储方案，暂不考虑分布式存储
- 使用现成的Markdown编辑器组件

### 7.2 功能简化

- 初期仅支持单用户或简单的用户系统
- Deep Research先实现基础版本，后续迭代优化
- 文件预览仅支持常见格式（PDF、TXT、MD）
- 暂不实现实时协作功能

### 7.3 部署简化

- 使用Docker Compose一键部署
- 提供详细的部署文档
- 支持主流云服务商（阿里云、腾讯云）
- 提供演示环境供测试

## 8. 项目亮点与差异化

### 8.1 核心创新

- **深度研究自动化**：一键启动全流程研究，自动整理知识体系
- **文件级AI对话**：精确到页码和段落的智能问答，不是简单的文档问答
- **知识自动关联**：AI自动发现和构建知识联系，形成知识网络
- **学习全流程支持**：从资料收集到知识输出的完整闭环

### 8.2 差异化优势

- **专注知识管理**：不是通用笔记工具，而是智能知识系统
- **AI深度集成**：不是简单的AI问答，而是贯穿全流程的智能辅助
- **学术研究友好**：专门优化的学术模式和引用管理
- **简洁高效**：面向大学生的轻量级设计，快速上手

### 8.3 技术亮点

- **现代化技术栈**：采用最新的Web技术，保证良好的开发体验
- **模块化设计**：便于功能扩展和维护
- **容器化部署**：简化部署流程，提高可移植性
- **AI模型灵活**：支持多种AI模型，满足不同需求

## 9. 未来展望

### 9.1 功能扩展

- **更多Agent**：AI PPT生成器、代码助手、写作助手
- **协作功能**：团队Space、实时协同编辑、评论系统
- **知识图谱**：可视化知识网络、概念关联图、学习路径
- **移动端应用**：随时随地访问知识库

### 9.2 产品愿景

Second Brain不仅是一个工具，更是用户的智能知识伙伴。通过AI技术的深度应用，实现"让知识管理变得简单而智能"的产品使命，帮助每个人构建属于自己的第二大脑。

























